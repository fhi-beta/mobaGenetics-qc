# Shows meta-info about the rules - typical documentation and what order they should show up in the documentation
# Each rule should match a corresponding snakemake rule
# These will be read into a dictionary and populated with results

# Minidocs for some of the fields (more to come laters)
#
# * Rule        : The rulename in the snakemake file.
# * Rule order  : Sort alphabetically by this to get the documentation/execution order.
#                 There is no guarantee that they rules are run in that order, but
#                 this is the normal order they should be documented in
# * Timetamp    : When the results of this rule was logged (UTC aka GMT)
# * rule type   : Either sample or marker
# * rule action : Wht the rule does to the date. Either remove or update
#
# Some items are not shown here at all, but will be inserted as results of the QC
# * in          : Number of markers/sample before rule
# * out         : Number of markers/sample after rule
# * actionTakenCount: Number of markers/samples affected by the rul


remove_chr0:
  QC test: Remove chromosone 0
  Description:
  Rule order: mod1-a
  rule type: markers
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 

update_sample_ids:
  QC test: Update sample ids
  Description: Mapping lab ids to moba ids
  Rule order: mod1-b
  rule type: samples
  rule action: update
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 

update_parents:
  QC test: Update parents
  Description: Parents updated based on moba information
  Rule order: mod1-c
  rule type: samples
  rule action: update
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry

update_sex:
  QC test: Update sex
  Description: Gender updated using to moba information
  Rule order: mod1-d
  rule type: samples
  rule action: update
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 


remove_duplicate_markers:
  QC test: Remove duplicate markers
  Description: When duplicate markers are found, only the one with best call rating is kept
  Rule order: mod1-e
  rule type: markers
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 

remove_markers_cluster_sep:
  QC test: Cluster separation
  Description:
  Rule order: mod1-f
  rule type: markers
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 

remove_markers_gc_score:
  QC test: GC 10% score
  Description:
  Rule order: mod1-g
  rule type: markers
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 

remove_markers_aa_theta_dev:
  QC test: AA Theta Deviation
  Description:
  Rule order: mod1-h
  rule type: markers
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp:

update_rsids:
  QC test: Update rsid of markers. After this step, rsIDs can be repeated in the .bim file
  Description: "See <url to come?> for info. Basically we use the GSA chip mapping, but ignore . and select an rsid were several are listed (creating fewer unique rsIDs). Also, chip ids on the form .1 .2 etc are not mapped. These would typcailly come from allele alternatives on the same rsID."
  Rule order: mod1-i
  rule type: markers
  rule action: update
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp:



maf_removal_markers: 
  QC test: Low minor allele frequencies of markers temporarily removed
  Description: plink --maf
  Rule order: mod2-a
  rule type: markers
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 

missing_genotype_samples:
  QC test: Remove samples due to high missing callrates (plink --mind)
  Description: Input to this is a previously --maf filtered marker set
  Rule order: mod2-b
  rule type: samples
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 

clean_samples:
  QC test: Permanently remove samples we don't like
  Description: Input to this is a previously --maf --mind filtered marker set
  Rule order: mod2-b1
  rule type: samples
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 
    
missing_genotype_markers:
  QC test: Temporary remove markers due high missing callrates (plink --geno)
  Description: Input is previously --maf and --mind reduced set
  Rule order: mod2-c
  rule type: markers
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 

exclude_unplaced_and_non_autosomal_markers:
  QC test: Remove non-autosomal and unplaced markers (plink--autosome)
  Description: Input is previously --maf --mind --geno reduced set
  Rule order: mod2-d
  rule type: markers
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 

hardy_weinberg_filtered_markers:
  QC test: Temporary remove markers due to low Hardy-Weinberg equilibrium (plink --hwe)
  Description: Input is previously --maf --mind --geno --autosome reduced set
  Rule order:  mod2-e
  # Describes what item (samples/markers) the rule works on
  rule type: markers
  rule action: remove
  # A couple of placeholders that will be set in the pipe
  Rule: Will become the same as the key of this entry
  Timestamp: 

exclude_strand_ambigious_markers:
  QC test: Temporary remove alleles GC/CG/AT/TA from markers
  Description:
  Rule order: mod2-f
  rule type: markers
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 

exclude_high_ld_markers:
  QC test: Temporary remove markers in high LD 
  Description: 
  Rule order: mod2-g
  rule type: markers
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 

prune_markers:
  QC test: Temporary prune markers due to  linkage disequilibrium
  Description: Uses plink --make-founders  indep-pairwise 
  Rule order: mod2-h
  rule type: markers
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 

pedigree_inconsistence_prep:
  QC test: Prepares for pedigree fix of inconsistent samples
  Description: Plink --sexcheck and --extract --genome
  Rule order: mod2-i
  rule type: markers
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 
    
pedigree_fu_detector_solver:
  QC test: Tries to fix triads/missplaced sample
  Description: A R-script inferped_FuckupDetectorAndSolver.R is run and it's result will be used as two new bedset.
    Both will be earlier pruned/full sets, but with a new .fam(ily) file
  Rule order: mod2-j
  rule type: samples
  rule action: update
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 

document_pedigree_fu_detector_solver:
  QC test: Documents changes to bedfiles as a result of the two previous steps
  Description: Just a comparing of samples/individuals changes
  Rule order: mod2-k
  rule type: samples
  rule action: update
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 

pedigree_fix_pruned:
  QC test: Removes pedigree-problematic samples form the pruned set based on earlier steps
  Description: Some of these steps have been manual (2019)
  Rule order: mod2-l
  rule type: samples
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 

prune_hapmap:
  QC test: The reference set hapmap (b36) needs to be reduced to the markers in the stydy (b37)
  Description: This rule used to be part of the earlier pcawhapmap. Also, the reference set will be made unique on marker-id.
  Rule order: mod2.1a
  rule type: markers
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 

pca_extracts:
  QC test: Prepare two bedsets (reference hapmap b36,  and study) for later merge and then pca
  Description: Uses plink to find difference between b36 (hapmap) and b37 (study) markers so we can exclude them from the pca
  Rule order: mod2.1b
  rule type: markers
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 
    
    
merge_study_and_hapmap:
  QC test: Before pca we merge manually made hapmap bedset + the pruned marker make earlier
  Description: "See previous step for description of the reference set"
  Rule order: mod2.1c
  rule type: markers
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 

    
  
merge_foundersoffspring:
  QC test:
  Description:
  Rule order: mod5-a
  rule type: samples
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 

set_mendelian_errors_missing:
  QC test:
  Description:
  Rule order: mod5-b
  rule type: markers
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 

hrc_verification_check:
  QC test:
  Description:
  Rule order: mod5-c
  rule type: markers
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 

split_by_chr:
  QC test:
  Description:
  Rule order: mod5-d
  rule type: markers
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this entry
  Timestamp: 

prepare_phased_for_imputation:
  QC test:
  Description:
  Rule order: mod5-e
  rule type: markers
  rule action: remove
  # Placeholders that the pipeline will fill in
  Rule: Will be the same as the key of this
  Timestamp: 
